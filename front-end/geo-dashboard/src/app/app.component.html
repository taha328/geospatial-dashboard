
<ng-container *ngIf="isLoggedIn">
  <nav class="modern-navbar">
    <div class="navbar-container">
      <!-- Brand Section -->
      <div class="navbar-brand">
        <div class="brand-icon">🗺️</div>
        <div class="brand-content">
          <h1 class="brand-title">{{ title | titlecase }}</h1>
          <span class="brand-subtitle">Système Géospatial </span>
        </div>
      </div>

      <!-- Navigation Links -->
      <div class="navbar-nav">
        <a routerLink="/map" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">🗺️</span>
          <span class="nav-text">Cartographie</span>
          <span class="nav-badge">Interactive</span>
        </a>
        <a routerLink="/assets" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">🏗️</span>
          <span class="nav-text">Gestion Actifs</span>
          <span class="nav-badge">Infrastructure</span>
        </a>

        <a *ngIf="isAdmin" routerLink="/users" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">👥</span>
          <span class="nav-text">Utilisateurs</span>
          <span class="nav-badge">Gestion</span>
        </a>
      </div>

      <!-- User Actions -->
      <div class="navbar-actions">
        <button class="action-btn notification-btn" (click)="toggleNotificationPanel()">
          <span class="btn-icon">🔔</span>
          <span class="notification-count" *ngIf="unreadNotificationCount > 0">{{ unreadNotificationCount }}</span>
        </button>
        <button class="action-btn logout-btn" (click)="logout()" title="Se déconnecter">
          <span class="btn-icon">🔓</span>
          <span class="btn-text">Logout</span>
        </button>

      </div>

      <!-- Mobile Menu Toggle -->
      <button class="mobile-toggle" (click)="toggleMobileMenu()">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </button>
    </div>

    <!-- Mobile Navigation Overlay -->
    <div class="mobile-nav-overlay" [class.active]="mobileMenuOpen" (click)="closeMobileMenu()">
      <div class="mobile-nav-content" (click)="$event.stopPropagation()">
        <div class="mobile-nav-header">
          <div class="mobile-brand">
            <span class="mobile-brand-icon">🗺️</span>
            <span class="mobile-brand-text">Geo Dashboard</span>
          </div>
          <button class="mobile-close" (click)="closeMobileMenu()">✕</button>
        </div>
        
        <div class="mobile-nav-links">
          <a routerLink="/map" routerLinkActive="active" class="mobile-nav-link" (click)="closeMobileMenu()">
            <span class="mobile-nav-icon">🗺️</span>
            <span class="mobile-nav-text">Cartographie Interactive</span>
          </a>

          <a *ngIf="isAdmin" routerLink="/users" routerLinkActive="active" class="mobile-nav-link" (click)="closeMobileMenu()">
            <span class="mobile-nav-icon">👥</span>
            <span class="mobile-nav-text">Gestion Utilisateurs</span>
          </a>
        </div>
        
        <div class="mobile-nav-footer">
          <button class="mobile-action-btn">
            <span class="mobile-action-icon">🔔</span>
            <span class="mobile-action-text">Notifications</span>
            <span class="mobile-notification-count" *ngIf="unreadNotificationCount > 0">{{ unreadNotificationCount }}</span>
          </button>
          <button class="mobile-action-btn">
            <span class="mobile-action-icon">👤</span>
            <span class="mobile-action-text">Mon Profil</span>
          </button>
          <button class="mobile-action-btn" (click)="logout()">
            <span class="mobile-action-icon">🔓</span>
            <span class="mobile-action-text">Se déconnecter</span>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Notification Panel -->
  <app-notification-panel 
    *ngIf="notificationPanelOpen"
    [notifications]="notifications"
    (close)="closeNotificationPanel()"
    (notificationClicked)="onNotificationClicked($event)"
    (markAllAsRead)="markAllNotificationsAsRead()">
  </app-notification-panel>

  <main class="app-content">
    <router-outlet></router-outlet>
  </main>
</ng-container>

<!-- Always show router-outlet for login and other public pages -->
<main class="login-content" *ngIf="!isLoggedIn">
  <router-outlet></router-outlet>
</main>
