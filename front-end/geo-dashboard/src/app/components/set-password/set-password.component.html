<div class="set-password-container">
  <div class="set-password-card">
    <!-- Header -->
    <div class="header">
      <div class="logo">
        <span class="logo-icon">🔐</span>
      </div>
      <h1 class="title">{{ isResetFlow ? 'Réinitialiser votre mot de passe' : 'Définir votre mot de passe' }}</h1>
      <p class="subtitle">{{ isResetFlow ? 'Créez un nouveau mot de passe pour votre compte' : 'Bienvenue ! Créez votre mot de passe pour accéder à GeoDashboard' }}</p>
    </div>

    <!-- Success Message -->
    <div *ngIf="success" class="success-message">
      <div class="success-icon">✅</div>
      <h3>{{ isResetFlow ? 'Mot de passe réinitialisé avec succès !' : 'Mot de passe défini avec succès !' }}</h3>
      <p>Vous allez être redirigé vers la page de connexion...</p>
    </div>

    <!-- Error Message -->
    <div *ngIf="error && !success" class="error-message">
      <div class="error-icon">⚠️</div>
      <p>{{ error }}</p>
    </div>

    <!-- Set Password Form -->
    <form *ngIf="!success" (ngSubmit)="onSubmit()" class="set-password-form">
      <!-- Email Field (Read-only) -->
      <div class="form-group">
        <label for="email" class="form-label">
          <span class="label-icon">📧</span>
          Adresse email
        </label>
        <input
          id="email"
          type="email"
          [value]="email"
          readonly
          class="form-input readonly"
        />
        <small class="form-help">{{ isResetFlow ? 'Cette adresse email est associée à votre compte' : 'Cette adresse email a été utilisée pour votre invitation' }}</small>
      </div>

      <!-- Password Field -->
      <div class="form-group">
        <label for="password" class="form-label">
          <span class="label-icon">🔒</span>
          Nouveau mot de passe
        </label>
        <input
          id="password"
          type="password"
          [(ngModel)]="password"
          name="password"
          placeholder="Votre mot de passe"
          required
          minlength="8"
          class="form-input"
          [class.error]="password && password.length < 8"
        />
        <small class="form-help">Minimum 8 caractères</small>
      </div>

      <!-- Confirm Password Field -->
      <div class="form-group">
        <label for="confirmPassword" class="form-label">
          <span class="label-icon">🔐</span>
          Confirmer le mot de passe
        </label>
        <input
          id="confirmPassword"
          type="password"
          [(ngModel)]="confirmPassword"
          name="confirmPassword"
          placeholder="Confirmer votre mot de passe"
          required
          class="form-input"
          [class.error]="confirmPassword && password !== confirmPassword"
        />
        <small class="form-help" [class.error-text]="confirmPassword && password !== confirmPassword">
          {{ confirmPassword && password !== confirmPassword ? 'Les mots de passe ne correspondent pas' : 'Retapez votre mot de passe' }}
        </small>
      </div>

      <!-- Submit Button -->
      <button
        type="submit"
        class="submit-button"
        [disabled]="loading || !password || !confirmPassword || password !== confirmPassword || password.length < 8"
      >
        <span class="button-icon" *ngIf="loading">⏳</span>
        <span class="button-icon" *ngIf="!loading">✅</span>
        <span>{{ loading ? (isResetFlow ? 'Réinitialisation...' : 'Création...') : (isResetFlow ? 'Réinitialiser mon mot de passe' : 'Créer mon mot de passe') }}</span>
      </button>
    </form>

    <!-- Footer -->
    <div class="footer" *ngIf="!success">
      <p>
        <a href="/login" class="login-link">← Retour à la connexion</a>
      </p>
      <p class="help-text">
        {{ isResetFlow ? 'Ce lien de réinitialisation expire dans 1 heure.' : 'Ce lien d\'invitation expire dans 24 heures.' }}
      </p>
    </div>
  </div>
</div>